---
import Layout from '../../layouts/Layout.astro';
import eventsData from '../../data/events.json';

// Group past events by year
const eventsByYear = eventsData.past_events.reduce((acc, event) => {
  if (!acc[event.year]) acc[event.year] = [];
  acc[event.year].push(event);
  return acc;
}, {});

const years = Object.keys(eventsByYear).sort((a, b) => b - a);
---

<Layout title="Event Archive | Smite Club">
  <style>
    .hero {
      background: linear-gradient(135deg, #0a0a1a 0%, #1e293b 100%);
      padding: 80px 0;
      text-align: center;
      color: white;
    }
    
    .hero h1 {
      font-size: 42px;
      margin-bottom: 15px;
    }
    
    .section {
      padding: 60px 0;
    }
    
    .year-section {
      margin-bottom: 60px;
    }
    
    .year-header {
      font-size: 28px;
      color: #0a0a1a;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid #7dd3fc;
    }
    
    .event-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
    }
    
    .event-archive-card {
      background: #ffffff;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 25px;
      transition: border-color 0.3s, transform 0.2s;
    }
    
    .event-archive-card:hover {
      border-color: #0ea5e9;
      transform: translateY(-2px);
    }
    
    .event-archive-card h3 {
      font-size: 22px;
      margin-bottom: 10px;
      color: #0a0a1a;
    }
    
    .event-date {
      color: #64748b;
      font-size: 15px;
      margin-bottom: 15px;
    }
    
    .winners-list {
      background: #f8fafc;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    
    .winner-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #e2e8f0;
      font-size: 14px;
    }
    
    .winner-item:last-child {
      border-bottom: none;
    }
    
    .winner-place {
      font-weight: 700;
      color: #c9a45c;
    }
    
    .winner-info {
      color: #475569;
    }
    
    .card-links {
      display: flex;
      gap: 15px;
    }
    
    .card-links a {
      color: #0ea5e9;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
    }
    
    .card-links a:hover {
      text-decoration: underline;
    }
    
    .note {
      color: #64748b;
      font-style: italic;
      font-size: 14px;
      margin-bottom: 15px;
    }
  </style>

  <section class="hero">
    <div class="container">
      <h1>Event Archive</h1>
      <p style="color: #94a3b8; font-size: 18px;">Results, winners, and memories from past tournaments</p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      {years.map(year => (
        <div class="year-section">
          <h2 class="year-header">{year}</h2>
          <div class="event-list">
            {eventsByYear[year].map(event => (
              <div class="event-archive-card">
                <h3>{event.full_name}</h3>
                <p class="event-date">üìÖ {event.date_display} ‚Ä¢ üìç {event.city}, {event.state}</p>
                
                {event.note && <p class="note">{event.note}</p>}
                
                {event.winners && event.winners.length > 0 && (
                  <div class="winners-list">
                    {event.winners.map(winner => (
                      <div class="winner-item">
                        <span class="winner-place">{winner.place}</span>
                        <span class="winner-info">{winner.name} ({winner.army})</span>
                      </div>
                    ))}
                  </div>
                )}
                
                <div class="card-links">
                  {event.gallery_url && <a href={event.gallery_url}>üì∏ Gallery</a>}
                  {event.results_url && <a href={event.results_url}>üìä Full Results</a>}
                  {!event.gallery_url && !event.results_url && (
                    <span style="color: #94a3b8; font-size: 14px;">Results coming soon</span>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      ))}
    </div>
  </section>
</Layout>
